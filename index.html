<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalWork Pro | Masterpiece V13</title>
    <style>
        @font-face {
            font-family: 'Digital';
            src: url('https://fonts.cdnfonts.com/s/14234/DS-DIGI.woff') format('woff');
        }
        :root { --primary: #00d2ff; --bg: #000; --card: #121212; --success: #2ecc71; --danger: #ff4b2b; --glow: #39FF14; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #fff; margin: 0; padding: 0; overflow: hidden; display: flex; flex-direction: column; align-items: center; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­ */
        #splash { position: fixed; inset: 0; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; }
        
        /* Ø³Ø§Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø¨ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .clock-container { position: relative; width: 220px; height: 220px; margin-top: 30px; border-radius: 50%; border: 4px solid #111; box-shadow: 0 0 20px rgba(0, 210, 255, 0.2), inset 0 0 15px rgba(0, 210, 255, 0.1); display: flex; justify-content: center; align-items: center; background: radial-gradient(circle, #0a0a0a 0%, #000 100%); }
        .clock-container::before { content: ''; position: absolute; width: 105%; height: 105%; border-radius: 50%; border: 2px solid var(--primary); opacity: 0.3; filter: blur(2px); }
        .analog-clock { position: relative; width: 100%; height: 100%; }
        .hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; border-radius: 10px; z-index: 10; }
        .hour-hand { width: 6px; height: 50px; background: #fff; box-shadow: 0 0 10px #fff; }
        .min-hand { width: 4px; height: 75px; background: var(--glow); box-shadow: 0 0 15px var(--glow); }
        .sec-hand { width: 2px; height: 85px; background: var(--danger); z-index: 11; }
        .center-dot { position: absolute; top: 50%; left: 50%; width: 12px; height: 12px; background: #fff; border-radius: 50%; transform: translate(-50%, -50%); z-index: 12; box-shadow: 0 0 10px #fff; }
        .number { position: absolute; font-size: 18px; font-weight: bold; color: #fff; transform: translate(-50%, -50%); }

        /* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ù‚Ø·Ø¹Ø© */
        #work-timer { font-family: 'Digital', Courier, monospace; font-size: 4.5rem; color: var(--primary); margin: 25px 0; text-shadow: 0 0 20px rgba(0, 210, 255, 0.6); letter-spacing: 5px; }

        /* Ø¨ÙˆÙƒØ³ ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù */
        #status-display { width: 85%; height: 80px; display: flex; flex-direction: column; justify-content: center; gap: 8px; font-size: 1.1rem; opacity: 0; transition: 0.5s; }
        .status-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; padding-bottom: 5px; }
        .status-label { color: #888; font-size: 0.9rem; }
        .status-time { color: var(--glow); font-weight: bold; text-shadow: 0 0 5px var(--glow); }

        /* Ø§Ù„ØªØ­ÙƒÙ… */
        .controls { width: 100%; display: flex; justify-content: center; gap: 40px; margin-top: auto; padding-bottom: 50px; }
        .circle-btn { width: 90px; height: 90px; border-radius: 50%; border: none; color: #fff; font-weight: bold; font-size: 14px; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .settings-icon { position: absolute; top: 20px; left: 20px; font-size: 24px; color: #555; cursor: pointer; }

        /* Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
        #toast { position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); background: #1a1a1a; border: 1px solid var(--primary); padding: 12px 30px; border-radius: 50px; z-index: 5000; transition: 0.5s; }
        #toast.show { bottom: 40px; }
        
        .menu { position: fixed; top: -100%; left: 0; width: 100%; background: var(--card); transition: 0.5s; padding: 25px; z-index: 1000; border-bottom: 2px solid var(--primary); border-radius: 0 0 25px 25px; box-sizing: border-box; }
        .menu.active { top: 0; }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal-box { background: var(--card); border: 1px solid #333; border-radius: 25px; padding: 20px; width: 85%; text-align: center; }
    </style>
</head>
<body onload="initApp()">

    <div id="splash"><h1>CalWork Pro</h1><p style="color:var(--primary)">V13 - Professional Edition</p></div>

    <div class="settings-icon" onclick="toggleMenu()">âš™ï¸</div>

    <div id="settingsMenu" class="menu">
        <div onclick="openCalendar()" style="padding:15px; border-bottom:1px solid #222">ğŸ“… Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…</div>
        <input type="email" id="targetEmail" placeholder="Ø¥ÙŠÙ…ÙŠÙ„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" onchange="saveEmail(this.value)" style="background:#111; border:1px solid #333; color:#fff; width:100%; padding:10px; margin:10px 0; border-radius:8px">
        <div onclick="toggleMenu()" style="padding:15px; color:var(--danger)">âœ• Ø¥ØºÙ„Ø§Ù‚</div>
    </div>

    <div class="clock-container">
        <div class="analog-clock">
            <div id="hour" class="hand hour-hand"></div>
            <div id="min" class="hand min-hand"></div>
            <div id="sec" class="hand sec-hand"></div>
            <div class="center-dot"></div>
            <div class="number" style="top:10%; left:50%">12</div>
            <div class="number" style="top:50%; left:90%">3</div>
            <div class="number" style="top:90%; left:50%">6</div>
            <div class="number" style="top:50%; left:10%">9</div>
        </div>
    </div>

    <div id="work-timer">00:00:00</div>

    <div id="status-display">
        <div id="in-row" class="status-row">
            <span class="status-time" id="in-time">--:--</span>
            <span class="status-label">ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ±</span>
        </div>
        <div id="out-row" class="status-row" style="display:none">
            <span class="status-time" id="out-time">--:--</span>
            <span class="status-label">ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØµØ±Ø§Ù</span>
        </div>
    </div>

    <div class="controls">
        <button id="inBtn" class="circle-btn" style="background:var(--success)" onclick="startProcess('in')">CHECK IN</button>
        <button id="outBtn" class="circle-btn" style="background:var(--danger); opacity:0.3" onclick="startProcess('out')">CHECK OUT</button>
    </div>

    <div id="toast">ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ…</div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyvmKQlFFEr5vkGe3GLCmAADIJRcGVnXWimP3NSQgNZ35SPaDzr91BV-JeJPicO0FVw/exec';
        let timer, seconds = 0, logs = JSON.parse(localStorage.getItem('calwork_db')) || {};

        function initApp() {
            updateClock();
            setInterval(updateClock, 1000);
            setTimeout(() => document.getElementById('splash').style.display='none', 2500);
        }

        // ØªØ­Ø¯ÙŠØ« Ø³Ø§Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø¨
        function updateClock() {
            const now = new Date();
            const h = now.getHours() % 12;
            const m = now.getMinutes();
            const s = now.getSeconds();
            document.getElementById('hour').style.transform = `translateX(-50%) rotate(${h * 30 + m * 0.5}deg)`;
            document.getElementById('min').style.transform = `translateX(-50%) rotate(${m * 6}deg)`;
            document.getElementById('sec').style.transform = `translateX(-50%) rotate(${s * 6}deg)`;
        }

        function startProcess(type) {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
            
            if (type === 'in') {
                seconds = 0;
                document.getElementById('inBtn').style.opacity = '0.3';
                document.getElementById('outBtn').style.opacity = '1';
                document.getElementById('status-display').style.opacity = '1';
                document.getElementById('in-time').innerText = timeStr;
                document.getElementById('out-row').style.display = 'none';
                window.entryTime = now;
                timer = setInterval(() => {
                    seconds++;
                    let hh = Math.floor(seconds/3600).toString().padStart(2,'0');
                    let mm = Math.floor((seconds%3600)/60).toString().padStart(2,'0');
                    let ss = (seconds%60).toString().padStart(2,'0');
                    document.getElementById('work-timer').innerText = `${hh}:${mm}:${ss}`;
                }, 1000);
            } else {
                clearInterval(timer);
                document.getElementById('out-row').style.display = 'flex';
                document.getElementById('out-time').innerText = timeStr;
                
                // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø³Ø­Ø§Ø¨
                const logEntry = {
                    date: now.toLocaleDateString('en-GB'),
                    in: window.entryTime.toLocaleTimeString('en-GB'),
                    out: now.toLocaleTimeString('en-GB'),
                    total: (seconds/3600).toFixed(2),
                    email: localStorage.getItem('targetEmail') || "guest"
                };
                fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(logEntry) });

                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†ÙŠ ÙˆØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯
                setTimeout(() => {
                    document.getElementById('status-display').style.opacity = '0';
                    document.getElementById('work-timer').innerText = "00:00:00";
                    document.getElementById('inBtn').style.opacity = '1';
                    document.getElementById('outBtn').style.opacity = '0.3';
                }, 10000);
            }
        }

        function toggleMenu() { document.getElementById('settingsMenu').classList.toggle('active'); }
        function saveEmail(v) { localStorage.setItem('targetEmail', v); }
        function openCalendar() { alert("Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ø§Ù„Ø³Ø¬Ù„..."); }
    </script>
</body>
</html>
